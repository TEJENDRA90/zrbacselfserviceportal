<mvc:View
	controllerName="rbacselfserviceportal.zrbacselfserviceportal.controller.Exceptions"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns="sap.m"
	xmlns:core="sap.ui.core"
	xmlns:table="sap.ui.table"
	displayBlock="true">
	
	<Page title="Exception Role Assignment" 
		  showHeader="true" 
		  class="sapUiResponsiveContentPadding">
		
		<content>
			<VBox class="sapUiMediumMargin">
				
				<!-- Search Bar -->
				<Panel headerText="Search Users" class="sapUiMediumMarginBottom">
					<content>
						<HBox alignItems="Center" class="sapUiTinyMarginTop">
							<Input placeholder="Search for user by name or ID..." 
								   value="{/searchTerm}"
								   class="sapUiTinyMarginEnd"
								   width="400px"/>
							<Button text="Search" 
									icon="sap-icon://search" 
									press="onSearchPress"
									type="Emphasized"/>
						</HBox>
					</content>
				</Panel>
				
				<!-- Users Table -->
				<Panel headerText="User List" class="sapUiMediumMarginBottom">
					<content>
						<table:Table id="usersTable"
									rows="{/filteredUsers}"
									selectionMode="None"
									enableBusyIndicator="true"
									class="sapUiTinyMarginTop">
							
							<table:columns>
								<table:Column width="250px">
									<Label text="User"/>
									<table:template>
										<VBox class="sapUiTinyMargin">
											<Text text="{name}" class="sapUiTinyMarginBottom"/>
											<Text text="({id})" 
												  class="sapUiTinyFontSize sapUiTextColorNeutral"/>
										</VBox>
									</table:template>
								</table:Column>
								
								<table:Column width="150px">
									<Label text="Job Title"/>
									<table:template>
										<Text text="{jobTitle}" class="sapUiTinyMargin"/>
									</table:template>
								</table:Column>
								
								<table:Column width="150px">
									<Label text="Department"/>
									<table:template>
										<Text text="{department}" class="sapUiTinyMargin"/>
									</table:template>
								</table:Column>
								
								<table:Column width="150px">
									<Label text="Active Exceptions"/>
									<table:template>
										<HBox alignItems="Center" class="sapUiTinyMargin">
											<core:Icon src="sap-icon://alert" 
													  size="1rem" 
													  color="Critical"
													  visible="{= ${activeExceptionsCount} > 0}"
													  class="sapUiTinyMarginEnd"/>
											<Text text="{activeExceptionsCount}" 
												  class="sapUiTinyMarginEnd"/>
										</HBox>
									</table:template>
								</table:Column>
								
								<table:Column width="120px">
									<Label text="Actions"/>
									<table:template>
										<Button text="Manage Roles" 
												press="onManageRolesPress"
												class="sapUiTinyMargin"
												type="Transparent"/>
									</table:template>
								</table:Column>
							</table:columns>
							
						</table:Table>
					</content>
				</Panel>
				
			</VBox>
		</content>
		
	</Page>
</mvc:View>
